<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Canvas Play Button</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <input type="file" id="fileInput" accept=".json" />
  <div class="pad-row">
    <button id="loadBtn">üìÇ</button>
    <label for="tempo-slider">BPM:</label>
    <input type="range" id="tempo-slider" min="30" max="300" step="1">
  <span id="tempo-value"></span>
  </div>
  <canvas id="myCanvas" width="1000" height="500" style="border:1px solid #000;"></canvas>
  <br>
  <button id="playButton">‚ñ∂Ô∏è</button>

  <script src="dataModel.js"></script>
  <script src="simulation.js"></script>
  <script>
    const canvas = document.getElementById('myCanvas');
    const ctx = canvas.getContext('2d');
    const camera = { x: 80, y: 130, z: 7 };
    const focalLength = 100;
    const objectHeight = 3;
    let currentStep = 0;
    let isPlaying = false;

    function drawRectangle() {
      ctx.fillStyle = 'blue';
      ctx.fillRect(50, 50, 100, 100);
    }

    function togglePlay() {
        isPlaying = !isPlaying;
        document.getElementById("playButton").textContent = isPlaying ? "‚èπÔ∏è" : "‚ñ∂Ô∏è";
        if (isPlaying) playLoop();
    }
    
    function playLoop() {
        if (!isPlaying) return;
        try {
            drawRectangle(); //advance();
            setTimeout(playLoop, (60 / tempo) * 1000);
        } catch (err) {
            console.log("Render error:", err);
        }
    }

  function loadfile() {
    const fileInput = document.getElementById('fileInput');
    const file = fileInput.files[0];
    if (!file) {
      alert("Please select a JSON file first.");
      return;
    }
  
    const reader = new FileReader();
    reader.onload = function(event) {
      console.log("Loading...");
      try {
        const json = JSON.parse(event.target.result);
  
        if (!Array.isArray(json)) {
          alert("Invalid format: JSON must be an array.");
          return;
        }
  
        kids = json;
        //alert("JSON loaded successfully! 'kids' array updated.");
        console.log(`Loaded ${kids.length} kids`);
        document.getElementById('projectName').value = file.name.replace(/\.json$/, "");
        setStartingFormation();
        render();
      } catch (e) {
        alert("Error parsing JSON: " + e.message);
      }
    };

    reader.readAsText(file);
  }

    document.getElementById('playButton').addEventListener('click', togglePlay);
    document.getElementById('loadBtn').addEventListener('click', loadfile);
    
  </script>
</body>
</html>


<!--<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Marching Drill Designer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <input type="text" id="projectName" placeholder="Project name" />
    <input type="file" id="fileInput" accept=".json" />
  <div class="pad-row">
    <button id="loadBtn">üìÇ</button>
    <label for="tempo-slider">BPM:</label>
    <input type="range" id="tempo-slider" min="30" max="300" step="1">
  <span id="tempo-value"></span>
  </div>
  <div class="controls">
    <div class="controls-top">
      <button id="rewindBtn">‚èÆÔ∏è</button>
      <button id="stepBackBtn">‚è™</button>
      <button id="playBtn">‚ñ∂Ô∏è</button>
      <button id="stepForwardBtn">‚è©</button>
      <span id="stepDisplay">Step: 0</span>
    </div>
    <div class="controls-bottom">
      <input type="range" id="scrubSlider" min="0" value="0">
    </div>
  <div id="canvas-container">
    <canvas id="viewport" width="1000" height="500"></canvas>
  </div>  
  
  <div id="statusDisplay" class="status-display"></div>
  <pre id="log" style="margin-top: 10px; font-family: monospace;"></pre>
  <script>
      (function () {
          const originalLog = console.log;
          const outputEl = document.getElementById('log');
        
          console.log = function (...args) {
            // Keep original behavior
            originalLog.apply(console, args);
        
            // Format output and write to the page
            const message = args.map(arg =>
              typeof arg === 'object' ? JSON.stringify(arg) : String(arg)
            ).join(' ');
            
            outputEl.textContent = message;
          };
        })();

      console.log("Ready");
  </script>

  <script src="dataModel.js"></script>
  <script src="simulation.js"></script>
  <script src="3d.js"></script>
  <script src="viewport.js"></script>
</body>
</html>
-->
